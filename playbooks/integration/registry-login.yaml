- hosts: all
  vars:
    container_registry_logins:
        trunk.registry.rdoproject.org:
            unused: test
  tasks:
    - include_role:
        name: ansible-role-container-registry
        tasks_from: registry-login.yml
      vars:
        no_log_login: false


    - debug:
        var: registry_login
    # We can't use the real credentials in this test, so it's enough that we get
    # an "unauthorized" response from the registry, meaning that the interaction works.
    - name: Assert role has worked
      assert:
        that:
          - registry_login is defined
          - '"unauthorized" in registry_login.results.0.stdout'
        success_msg: Role got to the authentication phase and correctly failed
        fail_msg: Role failed authentication for an Unknown reason.



