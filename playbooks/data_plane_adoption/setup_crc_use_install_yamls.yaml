- hosts: controller
  tasks:
    - name: Print the current CRC version
      ansible.builtin.shell: |
        crc version

    - name: Initialize OC Credentials
      ansible.builtin.include_role:
        name: add_crc_creds

    - name: set fact for install_yamls role var overrides
      ansible.builtin.set_fact:
        install_yamls_vars: |
          "NETWORK_ISOLATION": "false"

    - name: Deploy podified control plane using install_yamls
      vars:
        cifmw_install_yamls_vars: "{{ install_yamls_vars }}"
      ansible.builtin.include_role:
        name: install_yamls
        tasks_from: 'make_openstack_deploy'

    - name: Add additional sleep in order to finish the deploy
      ansible.builtin.shell: |
        sleep 200
      args:
        executable: /bin/bash
