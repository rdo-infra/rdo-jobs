- hosts: controller
  vars:
    framework_dir: "/home/zuul-worker/src/github.com/openstack-k8s-operators/ci-framework"

    rdo_dir: "/home/zuul-worker/src/review.rdoproject.org/rdo-jobs/playbooks/data_plane_adoption"
    module_dir: "/usr/share/ansible/plugins"
  tasks:
    - name: Print the current CRC version
      ansible.builtin.shell: |
        crc version

    - name: Initialize OC Credentials
      ansible.builtin.include_role:
        name: add_crc_creds

    - name: Run install_yamls via ci-framework
      ansible.builtin.shell: |
          ansible-galaxy collection install community.general
          mkdir -p /home/zuul-worker/ci-framework-data/logs
          ansible-playbook {{ rdo_dir }}/ci_framework_install_yamls.yaml
      args:
        chdir: "{{ framework_dir }}"
