---
- hosts: all
  vars:
    workspace: "{{ ansible_user_dir }}/workspace"
    package_manager_utils: >-
        {% if ansible_distribution_major_version|int >= 8 -%}
        dnf-utils
        {%- else -%}
        yum-utils
        {%- endif -%}
  tasks:
    - name: install yum/dnf-utils
      package:
        name: "{{ package_manager_utils }}"
        state: present

    - name: get repoquery list
      shell: >
        set -o pipefail &&
        repoquery --repoid="{{ dependency }}" -l | tee -a  {{ workspace }}/dependency_repoquery_list.log
      changed_when: false

    - name: display repo file contents
      shell: >
        cat {{ workspace }}/dependency_repoquery_list.log
      changed_when: false
