# TODO(gcerami): there were some problems in some distribution with the library required
# to use docker-login ansible module. We need to understand it the python library can be installed
# and eventually use just docker login command.


- name: Install and Start Docker
  when:
    - ansible_distribution == "CentOS"
    - ansible_distribution_major_version|int < 8
  become: true
  block:
    - name: Install Docker
      package:
        name: docker
        state: present
      register: container_registry_docker_install

    - name: Start Docker daemon
      service:
        name: docker
        state: started

- name: Install podman
  become: true
  package:
    name: podman
    state: present
  register: container_registry_podman_install
  when: >
    (ansible_distribution == "CentOS" and ansible_distribution_major_version|int >= 8)
    or (ansible_distribution == "RedHat" and ansible_lsb.major_release|int >= 8)
