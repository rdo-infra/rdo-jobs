---
# zuul.d/build-containers.yaml
# Zuul layout for TripleO Build Containers jobs.

- project-template:
    name: tripleo-build-containers-jobs
    openstack-check:
      jobs:
        - tripleo-build-containers-rhel-8-master
        - tripleo-build-containers-rhel-8-train

- job:
    name: tripleo-build-containers-rhel-8-master
    parent: tripleo-build-containers-base-with-files
    nodeset: single-rhel-8-node
    branches: master
    voting: true
    host-vars:
      primary:
        ansible_python_interpreter: /usr/bin/python3
      localhost:
        ansible_python_interpreter: /usr/bin/python3
    vars:
      release: master
      use_buildah: true
      # Keep string empty, or kolla will try to download delorean repos on its own
      buildcontainers_rpm_setup_config: ""
      kolla_base: rhel
      kolla_base_pull: false
      kolla_base_image: rhel
      kolla_base_tag: 8.0-126

- job:
    name: tripleo-build-containers-rhel-8-train
    parent: tripleo-build-containers-rhel-8-master
    branches: ^stable/train$
    vars:
      branch_override: 'stable/train'
      release: train

- job:
    name: tripleo-build-containers-rhel-8-train-branch
    parent: tripleo-build-containers-rhel-8-master
    override-checkout: stable/train
    vars:
      branch_override: stable/train

- job:
    name: tripleo-centos-7-master-nova-containers-build
    parent: periodic-tripleo-containers-build-push-base
    nodeset: single-centos-7-node
    vars:
       release: master
       push_containers: false
       component_ci_service: nova

