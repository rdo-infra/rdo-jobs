- project:
    name: rdo-jobs
    check:
      jobs:
        - tox-docs: &cfg
            nodeset: rdo-centos-8
            vars:
              # needed to avoid accidental call of /usr/bin/tox
              tox_executable: "{{ ansible_python.executable }} -m tox"
            pre-run:
              - playbooks/rdo-tox-epel.yaml
              - playbooks/pre-tox.yaml
        - tox-linters: *cfg
        - rdo-tox-molecule: &molecule
            files:
              - .*molecule.*
              - bindep.txt
              - requirements.txt$
              - roles/.*
              - setup.*$
              - test-requirements.txt
              - tox.ini
        - tripleo-centos-8-ceph-integration-master:
            files: &ceph
              - ./playbooks/tripleo-ceph-integration/.*
              - zuul.d/ceph-ansible.yaml
        - tripleo-ceph-integration-centos-8-scenario001-standalone:
            files: *ceph
            dependencies:
              - tripleo-centos-8-ceph-integration-master
        - tripleo-ceph-integration-centos-8-scenario004-standalone:
            files: *ceph
            dependencies:
              - tripleo-centos-8-ceph-integration-master

    gate:
      jobs:
        - tox-docs: *cfg
        - tox-linters: *cfg
        - rdo-tox-molecule: *molecule
