---
# zuul.d/rdoinfo-jobs.yaml
# Zuul layout for TripleO RDO Cloud related jobs.
# It contains all the jobs to run against rdoinfo changes.

- job:
    name: rdoinfo-tripleo-master-testing-centos-7-multinode-1ctlr-featureset016
    parent: tripleo-ci-base-multinode-rdo
    run: playbooks/run-rdoinfo.yaml
    timeout: 10800
    roles:
      - zuul: openstack/tripleo-ci
    vars:
      rdoinfo_release: master
      rdoinfo_phase: testing
      featureset: '016'
      nodes: 1ctlr
    required-projects:
      - openstack/devstack-gate
      - openstack/tripleo-quickstart
      - openstack/tripleo-quickstart-extras
      - openstack/tripleo-upgrade
      - x/browbeat
      - rdoinfo

# standalone counterpart for featurset016 multinode job
- job:
    name: rdoinfo-tripleo-master-centos-7-scenario001-standalone
    parent: tripleo-ci-base-standalone-rdo
    run: playbooks/run-rdoinfo.yaml
    post-run: playbooks/post-rdoinfo.yaml
    vars:
      featureset: '052'
      rdoinfo_release: master
      rdoinfo_phase: testing
      rdoinfo_build_containers: true
      use_buildah: true
      push_registry_port: 8786
      push_registry: 127.0.0.1:8786
      # This is needed as tag_from_label is not null, and hence it tries to inspect image from registry
      push_containers: true
      buildcontainers_override_repos: current-tripleo
      standalone_ceph: true
      featureset_override:
        standalone_container_cli: docker
        standalone_environment_files:
          - 'environments/low-memory-usage.yaml'
          - 'ci/environments/scenario001-standalone.yaml'
        tempest_plugins:
          - python-telemetry-tests-tempest
          - python-heat-tests-tempest
        test_white_regex: ''
        tempest_workers: 1
        tempest_extra_config: {'telemetry.alarm_granularity': '60'}
        tempest_whitelist:
          - 'tempest.api.identity.v3'
          - 'tempest.scenario.test_volume_boot_pattern.TestVolumeBootPattern.test_volume_boot_pattern'
          - 'telemetry_tempest_plugin.scenario.test_telemetry_integration.TestTelemetryIntegration'
    required-projects:
      - opendev.org/openstack/ansible-role-container-registry
      - opendev.org/openstack/kolla
      - opendev.org/openstack/python-tripleoclient
      - opendev.org/openstack/requirements
      - opendev.org/openstack/tripleo-common
      - opendev.org/openstack/tripleo-repos

- job:
    name: rdoinfo-tripleo-master-testing-centos-7-multinode-1ctlr-featureset010
    parent: tripleo-ci-base-multinode-rdo
    run: playbooks/run-rdoinfo.yaml
    timeout: 10800
    roles:
      - zuul: openstack/tripleo-ci
    vars:
      rdoinfo_release: master
      rdoinfo_phase: testing
      featureset: '010'
      nodes: 1ctlr
    required-projects:
      - openstack/devstack-gate
      - openstack/tripleo-quickstart
      - openstack/tripleo-quickstart-extras
      - openstack/tripleo-upgrade
      - x/browbeat
      - rdoinfo

- job:
    name: rdoinfo-tripleo-master-testing-centos-7-standalone-featureset052
    parent: tripleo-ci-base-standalone-rdo
    roles:
      - zuul: openstack/tripleo-ci
    run: playbooks/run-rdoinfo.yaml
    vars:
      featureset: '052'
      rdoinfo_release: master
      rdoinfo_phase: testing
    required-projects:
      - openstack/tripleo-quickstart
      - openstack/tripleo-quickstart-extras
      - openstack/tripleo-upgrade
      - x/browbeat
      - rdoinfo

- job:
    name: rdoinfo-tripleo-master-testing-centos-7-multinode-1ctlr-featureset030
    parent: tripleo-ci-base-multinode-rdo
    run: playbooks/run-rdoinfo.yaml
    timeout: 10800
    roles:
      - zuul: openstack/tripleo-ci
    vars:
      rdoinfo_release: master
      rdoinfo_phase: testing
      featureset: '030'
      nodes: 1ctlr
    required-projects:
      - openstack/devstack-gate
      - openstack/tripleo-quickstart
      - openstack/tripleo-quickstart-extras
      - openstack/tripleo-upgrade
      - x/browbeat
      - rdoinfo

# standalone counterpart for featurset030 multinode job
- job:
    name: rdoinfo-tripleo-master-centos-7-scenario007-standalone
    parent: tripleo-ci-base-standalone-rdo
    run: playbooks/run-rdoinfo.yaml
    vars:
      featureset: '052'
      rdoinfo_release: master
      rdoinfo_phase: testing
      featureset_override:
        standalone_container_cli: docker
        standalone_environment_files:
          - 'environments/low-memory-usage.yaml'
          - 'ci/environments/scenario007-standalone.yaml'
        test_white_regex: ''
        tempest_workers: 1
        tempest_whitelist:
          - 'tempest.scenario.test_network_basic_ops.TestNetworkBasicOps.test_network_basic_ops'

- job:
    name: rdoinfo-tripleo-train-centos-7-scenario001-standalone
    parent: tripleo-ci-base-standalone-rdo
    run: playbooks/run-rdoinfo.yaml
    post-run: playbooks/post-rdoinfo.yaml
    override-checkout: "stable/train"
    vars:
      featureset: '052'
      rdoinfo_release: train
      rdoinfo_phase: testing
      standalone_ceph: true
      branch_override: "stable/train"
      rdoinfo_build_containers: true
      use_buildah: true
      push_registry_port: 8786
      push_registry: 127.0.0.1:8786
      # This is needed as tag_from_label is not null, and hence it tries to inspect image from registry
      push_containers: true
      buildcontainers_override_repos: current-tripleo
      featureset_override:
        standalone_environment_files:
          - 'environments/low-memory-usage.yaml'
          - 'ci/environments/scenario001-standalone.yaml'
        tempest_plugins:
          - python-telemetry-tests-tempest
          - python-heat-tests-tempest
        test_white_regex: ''
        tempest_workers: 1
        tempest_extra_config: {'telemetry.alarm_granularity': '60'}
        tempest_whitelist:
          - 'tempest.api.identity.v3'
          - 'tempest.scenario.test_volume_boot_pattern.TestVolumeBootPattern.test_volume_boot_pattern'
          - 'telemetry_tempest_plugin.scenario.test_telemetry_integration.TestTelemetryIntegration'
    required-projects:
      - opendev.org/openstack/ansible-role-container-registry
      - opendev.org/openstack/kolla
      - opendev.org/openstack/python-tripleoclient
      - opendev.org/openstack/requirements
      - opendev.org/openstack/tripleo-common
      - opendev.org/openstack/tripleo-repos

- job:
    name: rdoinfo-tripleo-train-testing-centos-7-multinode-1ctlr-featureset010
    parent: tripleo-ci-base-multinode-rdo
    run: playbooks/run-rdoinfo.yaml
    timeout: 10800
    roles:
      - zuul: openstack/tripleo-ci
    override-checkout: "stable/train"
    vars:
      rdoinfo_release: train
      rdoinfo_phase: testing
      featureset: '010'
      nodes: 1ctlr
      branch_override: "stable/train"
    required-projects:
      - openstack/devstack-gate
      - openstack/tripleo-quickstart
      - openstack/tripleo-quickstart-extras
      - openstack/tripleo-upgrade
      - x/browbeat
      - rdoinfo

- job:
    name: rdoinfo-tripleo-train-testing-centos-7-standalone-featureset052
    parent: tripleo-ci-base-standalone-rdo
    roles:
      - zuul: openstack/tripleo-ci
    run: playbooks/run-rdoinfo.yaml
    override-checkout: "stable/train"
    vars:
      featureset: '052'
      rdoinfo_release: train
      rdoinfo_phase: testing
      branch_override: "stable/train"
    required-projects:
      - openstack/tripleo-quickstart
      - openstack/tripleo-quickstart-extras
      - openstack/tripleo-upgrade
      - x/browbeat
      - rdoinfo

- job:
    name: rdoinfo-tripleo-train-testing-centos-7-multinode-1ctlr-featureset030
    parent: tripleo-ci-base-multinode-rdo
    run: playbooks/run-rdoinfo.yaml
    timeout: 10800
    roles:
      - zuul: openstack/tripleo-ci
    override-checkout: "stable/train"
    vars:
      rdoinfo_release: train
      rdoinfo_phase: testing
      featureset: '030'
      nodes: 1ctlr
      branch_override: "stable/train"
    required-projects:
      - openstack/devstack-gate
      - openstack/tripleo-quickstart
      - openstack/tripleo-quickstart-extras
      - openstack/tripleo-upgrade
      - x/browbeat
      - rdoinfo

- job:
    name: rdoinfo-tripleo-stein-centos-7-scenario001-standalone
    parent: tripleo-ci-base-standalone-rdo
    run: playbooks/run-rdoinfo.yaml
    post-run: playbooks/post-rdoinfo.yaml
    override-checkout: "stable/stein"
    vars:
      featureset: '052'
      rdoinfo_release: stein
      rdoinfo_phase: testing
      standalone_ceph: true
      branch_override: "stable/stein"
      rdoinfo_build_containers: true
      use_buildah: true
      push_registry_port: 8786
      push_registry: 127.0.0.1:8786
      # This is needed as tag_from_label is not null, and hence it tries to inspect image from registry
      push_containers: true
      buildcontainers_override_repos: current-tripleo
      featureset_override:
        standalone_environment_files:
          - 'environments/low-memory-usage.yaml'
          - 'ci/environments/scenario001-standalone.yaml'
        tempest_plugins:
          - python-telemetry-tests-tempest
          - python-heat-tests-tempest
        test_white_regex: ''
        tempest_workers: 1
        tempest_extra_config: {'telemetry.alarm_granularity': '60'}
        tempest_whitelist:
          - 'tempest.api.identity.v3'
          - 'tempest.scenario.test_volume_boot_pattern.TestVolumeBootPattern.test_volume_boot_pattern'
          - 'telemetry_tempest_plugin.scenario.test_telemetry_integration.TestTelemetryIntegration'
    required-projects:
      - opendev.org/openstack/ansible-role-container-registry
      - opendev.org/openstack/kolla
      - opendev.org/openstack/python-tripleoclient
      - opendev.org/openstack/requirements
      - opendev.org/openstack/tripleo-common
      - opendev.org/openstack/tripleo-repos

- job:
    name: rdoinfo-tripleo-stein-release-centos-7-scenario001-standalone
    parent: tripleo-ci-base-standalone-rdo
    run: playbooks/run-rdoinfo-cbs.yaml
    post-run: playbooks/post-rdoinfo.yaml
    override-checkout: "stable/stein"
    vars:
      featureset: '052'
      rdoinfo_release: stein
      rdoinfo_phase: release
      standalone_ceph: true
      branch_override: "cloudsig/stein"
      rdoinfo_build_containers: true
      use_buildah: true
      push_registry_port: 8786
      push_registry: 127.0.0.1:8786
      # This is needed as tag_from_label is not null, and hence it tries to inspect image from registry
      push_containers: true
      buildcontainers_override_repos: current-tripleo
      buildcontainers_version_hash: cloudsig-stein
      buildcontainers_venv: false
      featureset_override:
        standalone_environment_files:
          - 'environments/low-memory-usage.yaml'
          - 'ci/environments/scenario001-standalone.yaml'
        tempest_plugins:
          - python-telemetry-tests-tempest
          - python-heat-tests-tempest
        test_white_regex: ''
        tempest_workers: 1
        tempest_extra_config: {'telemetry.alarm_granularity': '60'}
        tempest_whitelist:
          - 'tempest.api.identity.v3'
          - 'tempest.scenario.test_volume_boot_pattern.TestVolumeBootPattern.test_volume_boot_pattern'
          - 'telemetry_tempest_plugin.scenario.test_telemetry_integration.TestTelemetryIntegration'
    required-projects:
      - opendev.org/openstack/ansible-role-container-registry
      - opendev.org/openstack/kolla
      - opendev.org/openstack/python-tripleoclient
      - opendev.org/openstack/requirements
      - opendev.org/openstack/tripleo-common
      - opendev.org/openstack/tripleo-repos

- job:
    name: rdoinfo-tripleo-train-release-centos-7-scenario001-standalone
    parent: tripleo-ci-base-standalone-rdo
    run: playbooks/run-rdoinfo-cbs.yaml
    post-run: playbooks/post-rdoinfo.yaml
    override-checkout: "stable/train"
    vars:
      featureset: '052'
      rdoinfo_release: train
      rdoinfo_phase: release
      standalone_ceph: true
      branch_override: "cloudsig/train"
      rdoinfo_build_containers: true
      use_buildah: true
      push_registry_port: 8786
      push_registry: 127.0.0.1:8786
      # This is needed as tag_from_label is not null, and hence it tries to inspect image from registry
      push_containers: true
      buildcontainers_override_repos: current-tripleo
      buildcontainers_version_hash: cloudsig-train
      buildcontainers_venv: false
      featureset_override:
        standalone_environment_files:
          - 'environments/low-memory-usage.yaml'
          - 'ci/environments/scenario001-standalone.yaml'
        tempest_plugins:
          - python-telemetry-tests-tempest
          - python-heat-tests-tempest
        test_white_regex: ''
        tempest_workers: 1
        tempest_extra_config: {'telemetry.alarm_granularity': '60'}
        tempest_whitelist:
          - 'tempest.api.identity.v3'
          - 'tempest.scenario.test_volume_boot_pattern.TestVolumeBootPattern.test_volume_boot_pattern'
          - 'telemetry_tempest_plugin.scenario.test_telemetry_integration.TestTelemetryIntegration'
    required-projects:
      - opendev.org/openstack/ansible-role-container-registry
      - opendev.org/openstack/kolla
      - opendev.org/openstack/python-tripleoclient
      - opendev.org/openstack/requirements
      - opendev.org/openstack/tripleo-common
      - opendev.org/openstack/tripleo-repos

- job:
    name: rdoinfo-tripleo-stein-testing-centos-7-standalone-featureset052
    parent: tripleo-ci-base-standalone-rdo
    roles:
      - zuul: openstack/tripleo-ci
    run: playbooks/run-rdoinfo.yaml
    override-checkout: "stable/stein"
    vars:
      featureset: '052'
      rdoinfo_release: stein
      rdoinfo_phase: testing
      branch_override: "stable/stein"
    required-projects:
      - openstack/tripleo-quickstart
      - openstack/tripleo-quickstart-extras
      - openstack/tripleo-upgrade
      - x/browbeat
      - rdoinfo

- job:
    name: rdoinfo-tripleo-stein-testing-centos-7-multinode-1ctlr-featureset030
    parent: tripleo-ci-base-multinode-rdo
    run: playbooks/run-rdoinfo.yaml
    timeout: 10800
    roles:
      - zuul: openstack/tripleo-ci
    override-checkout: "stable/stein"
    vars:
      rdoinfo_release: stein
      rdoinfo_phase: testing
      featureset: '030'
      nodes: 1ctlr
      branch_override: "stable/stein"
    required-projects:
      - openstack/devstack-gate
      - openstack/tripleo-quickstart
      - openstack/tripleo-quickstart-extras
      - openstack/tripleo-upgrade
      - x/browbeat
      - rdoinfo

- job:
    name: rdoinfo-tripleo-rocky-testing-centos-7-multinode-1ctlr-featureset016
    parent: tripleo-ci-base-multinode-rdo
    run: playbooks/run-rdoinfo.yaml
    timeout: 10800
    roles:
      - zuul: openstack/tripleo-ci
    override-checkout: "stable/rocky"
    vars:
      rdoinfo_release: rocky
      rdoinfo_phase: testing
      branch_override: "stable/rocky"
      featureset: '016'
      nodes: 1ctlr
    required-projects:
      - openstack/devstack-gate
      - openstack/tripleo-quickstart
      - openstack/tripleo-quickstart-extras
      - openstack/tripleo-upgrade
      - x/browbeat
      - rdoinfo

- job:
    name: rdoinfo-tripleo-rocky-testing-centos-7-multinode-1ctlr-featureset030
    parent: tripleo-ci-base-multinode-rdo
    run: playbooks/run-rdoinfo.yaml
    timeout: 10800
    roles:
      - zuul: openstack/tripleo-ci
    override-checkout: "stable/rocky"
    vars:
      rdoinfo_release: rocky
      rdoinfo_phase: testing
      branch_override: "stable/rocky"
      featureset: '030'
      nodes: 1ctlr
    required-projects:
      - openstack/devstack-gate
      - openstack/tripleo-quickstart
      - openstack/tripleo-quickstart-extras
      - openstack/tripleo-upgrade
      - x/browbeat
      - rdoinfo

- job:
    name: rdoinfo-tripleo-rocky-release-centos-7-multinode-1ctlr-featureset016
    parent: tripleo-ci-base-multinode-rdo
    run: playbooks/run-rdoinfo.yaml
    timeout: 10800
    roles:
      - zuul: openstack/tripleo-ci
    override-checkout: "stable/rocky"
    vars:
      rdoinfo_release: rocky
      rdoinfo_phase: release
      branch_override: "stable/rocky"
      featureset: '016'
      nodes: 1ctlr
    required-projects:
      - openstack/devstack-gate
      - openstack/tripleo-quickstart
      - openstack/tripleo-quickstart-extras
      - openstack/tripleo-upgrade
      - x/browbeat
      - rdoinfo

- job:
    name: rdoinfo-tripleo-queens-testing-centos-7-multinode-1ctlr-featureset016
    parent: tripleo-ci-base-multinode-rdo
    run: playbooks/run-rdoinfo.yaml
    timeout: 10800
    roles:
      - zuul: openstack/tripleo-ci
    override-checkout: "stable/queens"
    vars:
      rdoinfo_release: queens
      rdoinfo_phase: testing
      branch_override: "stable/queens"
      featureset: '016'
      nodes: 1ctlr
    required-projects:
      - openstack/devstack-gate
      - openstack/tripleo-quickstart
      - openstack/tripleo-quickstart-extras
      - openstack/tripleo-upgrade
      - x/browbeat
      - rdoinfo

- job:
    name: rdoinfo-tripleo-queens-testing-centos-7-multinode-1ctlr-featureset030
    parent: tripleo-ci-base-multinode-rdo
    run: playbooks/run-rdoinfo.yaml
    timeout: 10800
    roles:
      - zuul: openstack/tripleo-ci
    override-checkout: "stable/queens"
    vars:
      rdoinfo_release: queens
      rdoinfo_phase: testing
      branch_override: "stable/queens"
      featureset: '030'
      nodes: 1ctlr
    required-projects:
      - openstack/devstack-gate
      - openstack/tripleo-quickstart
      - openstack/tripleo-quickstart-extras
      - openstack/tripleo-upgrade
      - x/browbeat
      - rdoinfo

- job:
    name: rdoinfo-tripleo-queens-release-centos-7-multinode-1ctlr-featureset016
    parent: tripleo-ci-base-multinode-rdo
    run: playbooks/run-rdoinfo.yaml
    timeout: 10800
    roles:
      - zuul: openstack/tripleo-ci
    override-checkout: "stable/queens"
    vars:
      rdoinfo_release: queens
      rdoinfo_phase: release
      branch_override: "stable/queens"
      featureset: '016'
      nodes: 1ctlr
    required-projects:
      - openstack/devstack-gate
      - openstack/tripleo-quickstart
      - openstack/tripleo-quickstart-extras
      - openstack/tripleo-upgrade
      - x/browbeat
      - rdoinfo

- job:
    name: rdoinfo-tripleo-master-testing-centos-8-standalone
    parent: tripleo-ci-centos-8-standalone
    run: playbooks/run-rdoinfo.yaml
    vars:
      rdoinfo_release: master
      rdoinfo_phase: testing

# Container build needs some work as docker-distribution removal from centos8
- job:
    name: rdoinfo-tripleo-master-testing-centos-8-scenario001-standalone
    parent: tripleo-ci-centos-8-scenario001-standalone
    run: playbooks/run-rdoinfo.yaml
    post-run: playbooks/post-rdoinfo.yaml
    vars:
      rdoinfo_release: master
      rdoinfo_phase: testing
      # change to true once ready
      rdoinfo_build_containers: false
      use_buildah: true
      kolla_base_pull: true
      kolla_base_tag: 8
      kolla_base_image: centos
      push_registry_port: 8786
      push_registry: 127.0.0.1:8786
      # This is needed as tag_from_label is not null, and hence it tries to inspect image from registry
      push_containers: true
      buildcontainers_override_repos: current-tripleo
    required-projects:
      - opendev.org/openstack/ansible-role-container-registry
      - opendev.org/openstack/kolla
      - opendev.org/openstack/python-tripleoclient
      - opendev.org/openstack/requirements
      - opendev.org/openstack/tripleo-common
      - opendev.org/openstack/tripleo-repos

- job:
    name: rdoinfo-tripleo-master-testing-centos-8-scenario007-standalone
    parent: tripleo-ci-centos-8-scenario007-standalone
    run: playbooks/run-rdoinfo.yaml
    vars:
      rdoinfo_release: master
      rdoinfo_phase: testing

- job:
    name: rdoinfo-tripleo-master-testing-centos-8-containers-multinode
    parent: tripleo-ci-centos-8-containers-multinode
    run: playbooks/run-rdoinfo.yaml
    vars:
      rdoinfo_release: master
      rdoinfo_phase: testing
